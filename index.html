<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>座席状態</title>
  </head>
  <body>
    <div id="app"></div>
    <script>
	fetch('/Support/connect-websocket')
    .then(response => response.text())
    .then(data => {
        const clientIp = data.trim(); // WebSocketのURLを取得
        const ws = new WebSocket("ws://localhost/Support/websocket/_administrator");
//        const ws = new WebSocket("ws://localhost/Support/websocket/teacher);-->
//        const ws = new WebSocket("ws://localhost/Support/websocket?ip="+clientIp);-->
        ws.onopen = () => {
    		ws.send('Hello from JavaScript client!');
            console.log("WebSocket connection opened.");
        };
        // メッセージを受信したときに呼び出される
		ws.onmessage = function(event) {
			alert("aaa"+event.data);
			const obj = JSON.parse(jsonData);
			const student=obj.clientStudent;
			const handupStudentList=obj.handupStudentList;
			const studentList=obj.studentList;
		    studentList.forEach(student => {
				alert(student.handPriority);
        		console.log(`Name: ${obj.name}, Age: ${obj.age}`);
    		});
    		console.log('Message received from server: ' + event.data);
		};

		// エラーが発生したときに呼び出される
		ws.onerror = function(error) {
    		alert("Error");
    		console.error('WebSocket error: ' + error);
		};

		// 接続が閉じられたときに呼び出される
		ws.onclose = function(event) {
    		console.log('WebSocket connection closed');
	    };
	});

	class Student {
      constructor(pcId,ipAddress,helpStatus,waitingTimeBySecond,handPriority) {
        this.pcId = pcId;
        this.ipAddress = ipAddress;
        this.helpStatus = helpStatus;
        this.waitingTimeBySecond = waitingTimeBySecond;
        this.handPriority = handPriority;
    }

 
}

	</script>
  </body>
</html>
